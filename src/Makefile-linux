CC=gcc
LD=ld

CFLAGS = -I./include -L./ -L./libs-linux -lpthread -lrt -lstdc++ -Wall -lm -Wextra -Wno-unused-parameter


ALL_EXE=iaaa-client
IAAA_CLIENT_OBJ=tlsq-dcu-logger.o tlsq-dcu-utils.o
MSGQ_OBJ=./msgQ/msgQ.o


all	: ${ALL_EXE}

iaaa-client : udp-server.c $(IAAA_CLIENT_OBJ) $(MSGQ_OBJ)
	$(CC) -o $@ udp-server.c $(IAAA_CLIENT_OBJ) $(MSGQ_OBJ) $(CFLAGS)
	rm -rf dist-linux/*
	cp libs-linux dist-linux/ -a
	cp include dist-linux/ -a
	cp conf/.curve/ dist-linux/ -a
	cp $(ALL_EXE) dist-linux/
	cp tlsq-dcu.conf dist-linux/

tlsq-dcu-logger.o : tlsq-dcu-logger.c
	$(CC) -c -fPIC tlsq-dcu-logger.c

tlsq-dcu-utils.o : tlsq-dcu-utils.c
	$(CC) -c tlsq-dcu-utils.c

base64-decode.o : base64-decode.c
	$(CC) -c -fPIC base64-decode.c

base64-encode.o : base64-encode.c
	$(CC) -c -fPIC base64-encode.c

buffer.o : buffer.c
	$(CC) -c -fPIC buffer.c


$(MSGQ_OBJ): ./msgQ/msgQ.c
	$(CC) -c -fPIC ./msgQ/msgQ.c -o ./msgQ/msgQ.o

clean:
	rm $(ALL_EXE) *.o 
	rm -f $(MSGQ_OBJ)

	
